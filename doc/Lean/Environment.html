<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href=".././style.css"></link><link rel="stylesheet" href=".././src/pygments.css"></link><link rel="shortcut icon" href=".././favicon.ico"></link><link rel="prefetch" href=".././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Environment</title><script defer="true" src=".././mathjax-config.js"></script><script defer="true" src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT=".././";</script><script>const MODULE_NAME="Lean.Environment";</script><script type="module" src=".././jump-src.js"></script><script type="module" src=".././search.js"></script><script type="module" src=".././expand-nav.js"></script><script type="module" src=".././how-about.js"></script><script type="module" src=".././instances.js"></script><script type="module" src=".././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label>Documentation</h1><p class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Environment</span></p><form action="https://google.com/search" method="get" id="search_form"><input type="hidden" name="sitesearch" value="https://leanprover-community.github.io/mathlib4_docs"></input><input type="text" name="q" autocomplete="off"></input>&#32;
            <button id="search_button" onclick="javascript: form.action='.././search.html';">Search</button><button>Google site search</button></form></header><nav class="internal_nav"><h3><a class="break_within" href="#top"><span class="name">Lean</span>.<span class="name">Environment</span></a></h3><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href=".././Init.html">Init</a></li><li><a href=".././Lean/Declaration.html">Lean.Declaration</a></li><li><a href=".././Lean/ImportingFlag.html">Lean.ImportingFlag</a></li><li><a href=".././Lean/LocalContext.html">Lean.LocalContext</a></li><li><a href=".././Lean/Data/HashMap.html">Lean.Data.HashMap</a></li><li><a href=".././Lean/Data/SMap.html">Lean.Data.SMap</a></li><li><a href=".././Lean/Util/FindExpr.html">Lean.Util.FindExpr</a></li><li><a href=".././Lean/Util/InstantiateLevelParams.html">Lean.Util.InstantiateLevelParams</a></li><li><a href=".././Lean/Util/Path.html">Lean.Util.Path</a></li><li><a href=".././Lean/Util/Profile.html">Lean.Util.Profile</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Environment" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionStateSpec"><span class="name">Lean</span>.<span class="name">EnvExtensionStateSpec</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionState"><span class="name">Lean</span>.<span class="name">EnvExtensionState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedEnvExtensionState"><span class="name">Lean</span>.<span class="name">instInhabitedEnvExtensionState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ModuleIdx"><span class="name">Lean</span>.<span class="name">ModuleIdx</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ModuleIdx.toNat"><span class="name">Lean</span>.<span class="name">ModuleIdx</span>.<span class="name">toNat</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedModuleIdx"><span class="name">Lean</span>.<span class="name">instInhabitedModuleIdx</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ConstMap"><span class="name">Lean</span>.<span class="name">ConstMap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Import"><span class="name">Lean</span>.<span class="name">Import</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instReprImport"><span class="name">Lean</span>.<span class="name">instReprImport</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedImport"><span class="name">Lean</span>.<span class="name">instInhabitedImport</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instCoeNameImport"><span class="name">Lean</span>.<span class="name">instCoeNameImport</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instToStringImport"><span class="name">Lean</span>.<span class="name">instToStringImport</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.CompactedRegion"><span class="name">Lean</span>.<span class="name">CompactedRegion</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.CompactedRegion.isMemoryMapped"><span class="name">Lean</span>.<span class="name">CompactedRegion</span>.<span class="name">isMemoryMapped</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.CompactedRegion.free"><span class="name">Lean</span>.<span class="name">CompactedRegion</span>.<span class="name">free</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionEntrySpec"><span class="name">Lean</span>.<span class="name">EnvExtensionEntrySpec</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionEntry"><span class="name">Lean</span>.<span class="name">EnvExtensionEntry</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instNonemptyEnvExtensionEntry"><span class="name">Lean</span>.<span class="name">instNonemptyEnvExtensionEntry</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ModuleData"><span class="name">Lean</span>.<span class="name">ModuleData</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedModuleData"><span class="name">Lean</span>.<span class="name">instInhabitedModuleData</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvironmentHeader"><span class="name">Lean</span>.<span class="name">EnvironmentHeader</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instNonemptyEnvironmentHeader"><span class="name">Lean</span>.<span class="name">instNonemptyEnvironmentHeader</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment"><span class="name">Lean</span>.<span class="name">Environment</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instNonemptyEnvironment"><span class="name">Lean</span>.<span class="name">instNonemptyEnvironment</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.addAux"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">addAux</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.addExtraName"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">addExtraName</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.find?"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">find?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.contains"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">contains</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.imports"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">imports</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.allImportedModuleNames"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">allImportedModuleNames</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.setMainModule"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">setMainModule</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.mainModule"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">mainModule</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.getModuleIdxFor?"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">getModuleIdxFor?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.isConstructor"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">isConstructor</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.getModuleIdx?"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">getModuleIdx?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.KernelException"><span class="name">Lean</span>.<span class="name">KernelException</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.addDecl"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">addDecl</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ConstantInfo.instantiateTypeLevelParams"><span class="name">Lean</span>.<span class="name">ConstantInfo</span>.<span class="name">instantiateTypeLevelParams</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ConstantInfo.instantiateValueLevelParams!"><span class="name">Lean</span>.<span class="name">ConstantInfo</span>.<span class="name">instantiateValueLevelParams!</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterface"><span class="name">Lean</span>.<span class="name">EnvExtensionInterface</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedEnvExtensionInterface"><span class="name">Lean</span>.<span class="name">instInhabitedEnvExtensionInterface</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.Ext"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">Ext</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.instInhabitedExt"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">instInhabitedExt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.ensureExtensionsArraySize"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">ensureExtensionsArraySize</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.ensureExtensionsArraySize.loop"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">ensureExtensionsArraySize</span>.<span class="name">loop</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.setState"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">setState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.modifyState"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">modifyState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.getState"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">getState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.registerExt"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">registerExt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.mkInitialExtStates"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">mkInitialExtStates</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceUnsafe.imp"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">imp</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtensionInterfaceImp"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceImp</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtension"><span class="name">Lean</span>.<span class="name">EnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtension.instInhabitedEnvExtension"><span class="name">Lean</span>.<span class="name">EnvExtension</span>.<span class="name">instInhabitedEnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtension.setState"><span class="name">Lean</span>.<span class="name">EnvExtension</span>.<span class="name">setState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtension.modifyState"><span class="name">Lean</span>.<span class="name">EnvExtension</span>.<span class="name">modifyState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.EnvExtension.getState"><span class="name">Lean</span>.<span class="name">EnvExtension</span>.<span class="name">getState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.registerEnvExtension"><span class="name">Lean</span>.<span class="name">registerEnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.mkEmptyEnvironment"><span class="name">Lean</span>.<span class="name">mkEmptyEnvironment</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.PersistentEnvExtensionState"><span class="name">Lean</span>.<span class="name">PersistentEnvExtensionState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ImportM.Context"><span class="name">Lean</span>.<span class="name">ImportM</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ImportM"><span class="name">Lean</span>.<span class="name">ImportM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.PersistentEnvExtension"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedPersistentEnvExtensionState"><span class="name">Lean</span>.<span class="name">instInhabitedPersistentEnvExtensionState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instInhabitedPersistentEnvExtension"><span class="name">Lean</span>.<span class="name">instInhabitedPersistentEnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.PersistentEnvExtension.getModuleEntries"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">getModuleEntries</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.PersistentEnvExtension.addEntry"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">addEntry</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.PersistentEnvExtension.getState"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">getState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.PersistentEnvExtension.setState"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">setState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.PersistentEnvExtension.modifyState"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">modifyState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.persistentEnvExtensionsRef"><span class="name">Lean</span>.<span class="name">persistentEnvExtensionsRef</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.PersistentEnvExtensionDescr"><span class="name">Lean</span>.<span class="name">PersistentEnvExtensionDescr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.registerPersistentEnvExtensionUnsafe"><span class="name">Lean</span>.<span class="name">registerPersistentEnvExtensionUnsafe</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.registerPersistentEnvExtension"><span class="name">Lean</span>.<span class="name">registerPersistentEnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.SimplePersistentEnvExtension"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.mkStateFromImportedEntries"><span class="name">Lean</span>.<span class="name">mkStateFromImportedEntries</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.SimplePersistentEnvExtensionDescr"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtensionDescr</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.registerSimplePersistentEnvExtension"><span class="name">Lean</span>.<span class="name">registerSimplePersistentEnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.SimplePersistentEnvExtension.instInhabitedSimplePersistentEnvExtension"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">instInhabitedSimplePersistentEnvExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.SimplePersistentEnvExtension.getEntries"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">getEntries</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.SimplePersistentEnvExtension.getState"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">getState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.SimplePersistentEnvExtension.setState"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">setState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.SimplePersistentEnvExtension.modifyState"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">modifyState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.TagDeclarationExtension"><span class="name">Lean</span>.<span class="name">TagDeclarationExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.mkTagDeclarationExtension"><span class="name">Lean</span>.<span class="name">mkTagDeclarationExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.TagDeclarationExtension.instInhabitedTagDeclarationExtension"><span class="name">Lean</span>.<span class="name">TagDeclarationExtension</span>.<span class="name">instInhabitedTagDeclarationExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.TagDeclarationExtension.tag"><span class="name">Lean</span>.<span class="name">TagDeclarationExtension</span>.<span class="name">tag</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.TagDeclarationExtension.isTagged"><span class="name">Lean</span>.<span class="name">TagDeclarationExtension</span>.<span class="name">isTagged</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.MapDeclarationExtension"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.mkMapDeclarationExtension"><span class="name">Lean</span>.<span class="name">mkMapDeclarationExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.MapDeclarationExtension.instInhabitedMapDeclarationExtension"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span>.<span class="name">instInhabitedMapDeclarationExtension</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.MapDeclarationExtension.insert"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span>.<span class="name">insert</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.MapDeclarationExtension.find?"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span>.<span class="name">find?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.MapDeclarationExtension.contains"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span>.<span class="name">contains</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.saveModuleData"><span class="name">Lean</span>.<span class="name">saveModuleData</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.readModuleData"><span class="name">Lean</span>.<span class="name">readModuleData</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.freeRegions"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">freeRegions</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.mkModuleData"><span class="name">Lean</span>.<span class="name">mkModuleData</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.writeModule"><span class="name">Lean</span>.<span class="name">writeModule</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.mkExtNameMap"><span class="name">Lean</span>.<span class="name">mkExtNameMap</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.updateEnvAttributes"><span class="name">Lean</span>.<span class="name">updateEnvAttributes</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.getNumBuiltinAttributes"><span class="name">Lean</span>.<span class="name">getNumBuiltinAttributes</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ImportState"><span class="name">Lean</span>.<span class="name">ImportState</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.throwAlreadyImported"><span class="name">Lean</span>.<span class="name">throwAlreadyImported</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ImportStateM"><span class="name">Lean</span>.<span class="name">ImportStateM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.ImportStateM.run"><span class="name">Lean</span>.<span class="name">ImportStateM</span>.<span class="name">run</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.importModulesCore"><span class="name">Lean</span>.<span class="name">importModulesCore</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.finalizeImport"><span class="name">Lean</span>.<span class="name">finalizeImport</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.importModules"><span class="name">Lean</span>.<span class="name">importModules</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.withImportModules"><span class="name">Lean</span>.<span class="name">withImportModules</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.namespacesExt"><span class="name">Lean</span>.<span class="name">namespacesExt</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.registerNamespace"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">registerNamespace</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.isNamespace"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">isNamespace</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.getNamespaceSet"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">getNamespaceSet</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.add"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">add</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.displayStats"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">displayStats</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.evalConst"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">evalConst</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.evalConstCheck"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">evalConstCheck</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Environment.hasUnsafe"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">hasUnsafe</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Kernel.isDefEq"><span class="name">Lean</span>.<span class="name">Kernel</span>.<span class="name">isDefEq</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Kernel.isDefEqGuarded"><span class="name">Lean</span>.<span class="name">Kernel</span>.<span class="name">isDefEqGuarded</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Kernel.whnf"><span class="name">Lean</span>.<span class="name">Kernel</span>.<span class="name">whnf</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.MonadEnv"><span class="name">Lean</span>.<span class="name">MonadEnv</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.instMonadEnv"><span class="name">Lean</span>.<span class="name">instMonadEnv</span></a></div></nav><main>
<div class="decl" id="Lean.EnvExtensionStateSpec"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L18-L18">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionStateSpec"><span class="name">Lean</span>.<span class="name">EnvExtensionStateSpec</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">(α : <a href=".././foundational_types.html">Type</a>) × <span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">α</span></span></span></div></div><p>Opaque environment extension state.</p></div></div><div class="decl" id="Lean.EnvExtensionState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L19-L19">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionState"><span class="name">Lean</span>.<span class="name">EnvExtensionState</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instInhabitedEnvExtensionState"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L20-L20">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instInhabitedEnvExtensionState"><span class="name">Lean</span>.<span class="name">instInhabitedEnvExtensionState</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionState">Lean.EnvExtensionState</a></span></div></div></div></div><div class="decl" id="Lean.ModuleIdx"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L22-L23">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ModuleIdx"><span class="name">Lean</span>.<span class="name">ModuleIdx</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ModuleIdx" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.ModuleIdx.toNat"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L25-L25">source</a></div><div class="attributes">@[inline, reducible]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ModuleIdx.toNat"><span class="name">Lean</span>.<span class="name">ModuleIdx</span>.<span class="name">toNat</span></a></span><span class="decl_args">
<span class="fn">(midx : <a href=".././Lean/Environment.html#Lean.ModuleIdx">Lean.ModuleIdx</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Nat">Nat</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ModuleIdx.toNat" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instInhabitedModuleIdx"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L27-L27">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instInhabitedModuleIdx"><span class="name">Lean</span>.<span class="name">instInhabitedModuleIdx</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Environment.html#Lean.ModuleIdx">Lean.ModuleIdx</a></span></div></div></div></div><div class="decl" id="Lean.ConstMap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L29-L29">source</a></div><div class="attributes">@[inline, reducible]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ConstMap"><span class="name">Lean</span>.<span class="name">ConstMap</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ConstMap" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Import"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L31-L34">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Import"><span class="name">Lean</span>.<span class="name">Import</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Import.mk"><li id="Lean.Import.module" class="structure_field"><div class="structure_field_info">module : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></div></li><li id="Lean.Import.runtimeOnly" class="structure_field"><div class="structure_field_info">runtimeOnly : <a href=".././Init/Prelude.html#Bool">Bool</a></div></li></ul><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Import" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instReprImport"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L34-L34">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instReprImport"><span class="name">Lean</span>.<span class="name">instReprImport</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Data/Repr.html#Repr">Repr</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span></div></div></div></div><div class="decl" id="Lean.instInhabitedImport"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L34-L34">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instInhabitedImport"><span class="name">Lean</span>.<span class="name">instInhabitedImport</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span></div></div></div></div><div class="decl" id="Lean.instCoeNameImport"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L36-L36">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instCoeNameImport"><span class="name">Lean</span>.<span class="name">instCoeNameImport</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span></div></div></div></div><div class="decl" id="Lean.instToStringImport"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L38-L38">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instToStringImport"><span class="name">Lean</span>.<span class="name">instToStringImport</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Data/ToString/Basic.html#ToString">ToString</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span></div></div></div></div><div class="decl" id="Lean.CompactedRegion"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L44-L44">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.CompactedRegion"><span class="name">Lean</span>.<span class="name">CompactedRegion</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>A compacted region holds multiple Lean objects in a contiguous memory region, which can be read/written to/from disk.
Objects inside the region do not have reference counters and cannot be freed individually. The contents of .olean
files are compacted regions.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.CompactedRegion" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.CompactedRegion.isMemoryMapped"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L47-L47">source</a></div><div class="attributes">@[extern  lean_compacted_region_is_memory_mapped]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.CompactedRegion.isMemoryMapped"><span class="name">Lean</span>.<span class="name">CompactedRegion</span>.<span class="name">isMemoryMapped</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Lean/Environment.html#Lean.CompactedRegion">Lean.CompactedRegion</a> → <a href=".././Init/Prelude.html#Bool">Bool</a></span></div></div></div></div><div class="decl" id="Lean.CompactedRegion.free"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L51-L51">source</a></div><div class="attributes">@[extern  lean_compacted_region_free]</div>
<div class="decl_header"><span class="decl_kind">unsafe opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.CompactedRegion.free"><span class="name">Lean</span>.<span class="name">CompactedRegion</span>.<span class="name">free</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Lean/Environment.html#Lean.CompactedRegion">Lean.CompactedRegion</a> → <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Init/Prelude.html#Unit">Unit</a></span></span></div></div><p>Free a compacted region and its contents. No live references to the contents may exist at the time of invocation.</p></div></div><div class="decl" id="Lean.EnvExtensionEntrySpec"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L54-L54">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionEntrySpec"><span class="name">Lean</span>.<span class="name">EnvExtensionEntrySpec</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#NonemptyType">NonemptyType</a></div></div><p>Opaque persistent environment extension entry.</p></div></div><div class="decl" id="Lean.EnvExtensionEntry"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L55-L55">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionEntry"><span class="name">Lean</span>.<span class="name">EnvExtensionEntry</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionEntry" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instNonemptyEnvExtensionEntry"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L56-L56">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instNonemptyEnvExtensionEntry"><span class="name">Lean</span>.<span class="name">instNonemptyEnvExtensionEntry</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionEntry">Lean.EnvExtensionEntry</a></span></div></div></div></div><div class="decl" id="Lean.ModuleData"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L60-L77">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ModuleData"><span class="name">Lean</span>.<span class="name">ModuleData</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.ModuleData.mk"><li id="Lean.ModuleData.imports" class="structure_field"><div class="structure_field_info">imports : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span></div></li><li id="Lean.ModuleData.constNames" class="structure_field"><div class="structure_field_info">constNames : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div><div class="structure_field_doc"><p><code><a href=".././Lean/Environment.html#Lean.ModuleData.constNames">constNames</a></code> contains all constant names in <code><a href=".././Lean/Environment.html#Lean.ModuleData.constants">constants</a></code>.
This information is redundant. It is equal to <code>constants.map fun c => c.<a href=".././Lean/Environment.html#Lean.PersistentEnvExtension.name">name</a></code>,
but it improves the performance of <code><a href=".././Lean/Environment.html#Lean.importModules">importModules</a></code>. <code>perf</code> reports that 12% of the
runtime was being spent on <code>ConstantInfo.<a href=".././Lean/Environment.html#Lean.PersistentEnvExtension.name">name</a></code> when importing a file containing only <code>import <a href=".././Lean.html">Lean</a></code></p></div></li><li id="Lean.ModuleData.constants" class="structure_field"><div class="structure_field_info">constants : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a></span></div></li><li id="Lean.ModuleData.extraConstNames" class="structure_field"><div class="structure_field_info">extraConstNames : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div><div class="structure_field_doc"><p>Extra entries for the <code><a href=".././Lean/Environment.html#Lean.Environment.const2ModIdx">const2ModIdx</a></code> map in the <code><a href=".././Lean/Environment.html#Lean.Environment">Environment</a></code> object.
The code generator creates auxiliary declarations that are not in the
mapping <code><a href=".././Lean/Environment.html#Lean.ModuleData.constants">constants</a></code>, but we want to know in which module they were generated.</p></div></li><li id="Lean.ModuleData.entries" class="structure_field"><div class="structure_field_info">entries : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> (<span class="fn"><a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> <a href=".././Init/Prelude.html#Prod">×</a> <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionEntry">Lean.EnvExtensionEntry</a></span></span>)</span></div></li></ul><p>Content of a .olean file.
We use <code>compact.cpp</code> to generate the image of this object in disk.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ModuleData" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instInhabitedModuleData"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L77-L77">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instInhabitedModuleData"><span class="name">Lean</span>.<span class="name">instInhabitedModuleData</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Environment.html#Lean.ModuleData">Lean.ModuleData</a></span></div></div></div></div><div class="decl" id="Lean.EnvironmentHeader"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L80-L103">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvironmentHeader"><span class="name">Lean</span>.<span class="name">EnvironmentHeader</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.EnvironmentHeader.mk"><li id="Lean.EnvironmentHeader.trustLevel" class="structure_field"><div class="structure_field_info">trustLevel : <a href=".././Init/Prelude.html#UInt32">UInt32</a></div><div class="structure_field_doc"><p>The trust level used by the kernel. For example,
the kernel assumes imported constants are type correct when the trust level is greater than zero.</p></div></li><li id="Lean.EnvironmentHeader.quotInit" class="structure_field"><div class="structure_field_info">quotInit : <a href=".././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p><code><a href=".././Lean/Environment.html#Lean.EnvironmentHeader.quotInit">quotInit</a> = true</code> if the command <code>init_quot</code> has already been executed for the environment, and
<code><a href=".././Init/Prelude.html#Quot">Quot</a></code> declarations have been added to the environment.</p></div></li><li id="Lean.EnvironmentHeader.mainModule" class="structure_field"><div class="structure_field_info">mainModule : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></div><div class="structure_field_doc"><p>Name of the module being compiled.</p></div></li><li id="Lean.EnvironmentHeader.imports" class="structure_field"><div class="structure_field_info">imports : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span></div><div class="structure_field_doc"><p>Direct imports</p></div></li><li id="Lean.EnvironmentHeader.regions" class="structure_field"><div class="structure_field_info">regions : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.CompactedRegion">Lean.CompactedRegion</a></span></div><div class="structure_field_doc"><p>Compacted regions for all imported modules. Objects in compacted memory regions do no require any memory management.</p></div></li><li id="Lean.EnvironmentHeader.moduleNames" class="structure_field"><div class="structure_field_info">moduleNames : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div><div class="structure_field_doc"><p>Name of all imported modules (directly and indirectly).</p></div></li><li id="Lean.EnvironmentHeader.moduleData" class="structure_field"><div class="structure_field_info">moduleData : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.ModuleData">Lean.ModuleData</a></span></div><div class="structure_field_doc"><p>Module data for all imported modules.</p></div></li></ul><p>Environment fields that are not used often.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvironmentHeader" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instNonemptyEnvironmentHeader"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L103-L103">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instNonemptyEnvironmentHeader"><span class="name">Lean</span>.<span class="name">instNonemptyEnvironmentHeader</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <a href=".././Lean/Environment.html#Lean.EnvironmentHeader">Lean.EnvironmentHeader</a></span></div></div></div></div><div class="decl" id="Lean.Environment"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L119-L148">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment"><span class="name">Lean</span>.<span class="name">Environment</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.Environment.mk"><li id="Lean.Environment.const2ModIdx" class="structure_field"><div class="structure_field_info">const2ModIdx : <span class="fn"><a href=".././Lean/Data/HashMap.html#Lean.HashMap">Lean.HashMap</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> <a href=".././Lean/Environment.html#Lean.ModuleIdx">Lean.ModuleIdx</a></span></div><div class="structure_field_doc"><p>Mapping from constant name to module (index) where constant has been declared.
Recall that a Lean file has a header where previously compiled modules can be imported.
Each imported module has a unique <code><a href=".././Lean/Environment.html#Lean.ModuleIdx">ModuleIdx</a></code>.
Many extensions use the <code><a href=".././Lean/Environment.html#Lean.ModuleIdx">ModuleIdx</a></code> to efficiently retrieve information stored in imported modules.</p><p>Remark: this mapping also contains auxiliary constants, created by the code generator, that are <strong>not</strong> in
the field <code><a href=".././Lean/Environment.html#Lean.ModuleData.constants">constants</a></code>. These auxiliary constants are invisible to the Lean kernel and elaborator.
Only the code generator uses them.</p></div></li><li id="Lean.Environment.constants" class="structure_field"><div class="structure_field_info">constants : <a href=".././Lean/Environment.html#Lean.ConstMap">Lean.ConstMap</a></div><div class="structure_field_doc"><p>Mapping from constant name to <code>ConstantInfo</code>. It contains all constants (definitions, theorems, axioms, etc)
that have been already type checked by the kernel.</p></div></li><li id="Lean.Environment.extensions" class="structure_field"><div class="structure_field_info">extensions : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionState">Lean.EnvExtensionState</a></span></div><div class="structure_field_doc"><p>Environment extensions. It also includes user-defined extensions.</p></div></li><li id="Lean.Environment.extraConstNames" class="structure_field"><div class="structure_field_info">extraConstNames : <a href=".././Lean/Data/NameMap.html#Lean.NameSet">Lean.NameSet</a></div><div class="structure_field_doc"><p>Constant names to be saved in the field <code><a href=".././Lean/Environment.html#Lean.ModuleData.extraConstNames">extraConstNames</a></code> at <code><a href=".././Lean/Environment.html#Lean.ModuleData">ModuleData</a></code>.
It contains auxiliary declaration names created by the code generator which are not in <code><a href=".././Lean/Environment.html#Lean.ModuleData.constants">constants</a></code>.
When importing modules, we want to insert them at <code><a href=".././Lean/Environment.html#Lean.Environment.const2ModIdx">const2ModIdx</a></code>.</p></div></li><li id="Lean.Environment.header" class="structure_field"><div class="structure_field_info">header : <a href=".././Lean/Environment.html#Lean.EnvironmentHeader">Lean.EnvironmentHeader</a></div><div class="structure_field_doc"><p>The header contains additional information that is not updated often.</p></div></li></ul><p>An environment stores declarations provided by the user. The kernel
currently supports different kinds of declarations such as definitions, theorems,
and inductive families. Each has a unique identifier (i.e., <code>Name</code>), and can be
parameterized by a sequence of universe parameters.
A constant in Lean is just a reference to a <code>ConstantInfo</code> object. The main task of
the kernel is to type check these declarations and refuse type incorrect ones. The
kernel does not allow declarations containing metavariables and/or free variables
to be added to an environment. Environments are never destructively updated.</p><p>The environment also contains a collection of extensions. For example, the <code>simp</code> theorems
declared by users are stored in an environment extension. Users can declare new extensions
using meta-programming.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instNonemptyEnvironment"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L148-L148">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instNonemptyEnvironment"><span class="name">Lean</span>.<span class="name">instNonemptyEnvironment</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></div></div></div></div><div class="decl" id="Lean.Environment.addAux"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L152-L153">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.addAux"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">addAux</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(cinfo : <a href=".././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.addAux" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.addExtraName"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L160-L164">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.addExtraName"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">addExtraName</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(name : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><p>Save an extra constant name that is used to populate <code><a href=".././Lean/Environment.html#Lean.Environment.const2ModIdx">const2ModIdx</a></code> when we import
.olean files. We use this feature to save in which module an auxiliary declaration
created by the code generator has been created.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.addExtraName" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.find?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L167-L169">source</a></div><div class="attributes">@[export lean_environment_find]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.find?"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">find?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(n : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.find?" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.contains"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L171-L172">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.contains"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">contains</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(n : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.contains" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.imports"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L174-L175">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.imports"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">imports</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.imports" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.allImportedModuleNames"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L177-L178">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.allImportedModuleNames"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">allImportedModuleNames</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.allImportedModuleNames" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.setMainModule"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L181-L182">source</a></div><div class="attributes">@[export lean_environment_set_main_module]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.setMainModule"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">setMainModule</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(m : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.setMainModule" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.mainModule"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L185-L186">source</a></div><div class="attributes">@[export lean_environment_main_module]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.mainModule"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">mainModule</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.mainModule" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.getModuleIdxFor?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L200-L201">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.getModuleIdxFor?"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">getModuleIdxFor?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(declName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Lean/Environment.html#Lean.ModuleIdx">Lean.ModuleIdx</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.getModuleIdxFor?" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.isConstructor"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L203-L206">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.isConstructor"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">isConstructor</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(declName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.isConstructor" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.getModuleIdx?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L208-L209">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.getModuleIdx?"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">getModuleIdx?</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(moduleName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <a href=".././Lean/Environment.html#Lean.ModuleIdx">Lean.ModuleIdx</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.getModuleIdx?" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.KernelException"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L214-L229">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.KernelException"><span class="name">Lean</span>.<span class="name">KernelException</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="constructors"><li class="constructor" id="Lean.KernelException.unknownConstant">unknownConstant: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></li><li class="constructor" id="Lean.KernelException.alreadyDeclared">alreadyDeclared: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></li><li class="constructor" id="Lean.KernelException.declTypeMismatch">declTypeMismatch: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Lean/Declaration.html#Lean.Declaration">Lean.Declaration</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></li><li class="constructor" id="Lean.KernelException.declHasMVars">declHasMVars: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></li><li class="constructor" id="Lean.KernelException.declHasFVars">declHasFVars: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></li><li class="constructor" id="Lean.KernelException.funExpected">funExpected: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></li><li class="constructor" id="Lean.KernelException.typeExpected">typeExpected: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></li><li class="constructor" id="Lean.KernelException.letTypeMismatch">letTypeMismatch: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a> → <span class="fn"><a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></span></li><li class="constructor" id="Lean.KernelException.exprTypeMismatch">exprTypeMismatch: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></li><li class="constructor" id="Lean.KernelException.appTypeMismatch">appTypeMismatch: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></li><li class="constructor" id="Lean.KernelException.invalidProj">invalidProj: <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a> → <span class="fn"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></span></span></li><li class="constructor" id="Lean.KernelException.other">other: <span class="fn"><a href=".././Init/Prelude.html#String">String</a> → <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></span></li><li class="constructor" id="Lean.KernelException.deterministicTimeout">deterministicTimeout: <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></li><li class="constructor" id="Lean.KernelException.excessiveMemory">excessiveMemory: <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></li><li class="constructor" id="Lean.KernelException.deepRecursion">deepRecursion: <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a></li></ul><p>Exceptions that can be raised by the Kernel when type checking new declarations.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.KernelException" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.addDecl"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L235-L235">source</a></div><div class="attributes">@[extern  lean_add_decl]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.addDecl"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">addDecl</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(decl : <a href=".././Lean/Declaration.html#Lean.Declaration">Lean.Declaration</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Except">Except</a> <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></div></div><p>Type check given declaration and add it to the environment</p></div></div><div class="decl" id="Lean.ConstantInfo.instantiateTypeLevelParams"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L241-L242">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ConstantInfo.instantiateTypeLevelParams"><span class="name">Lean</span>.<span class="name">ConstantInfo</span>.<span class="name">instantiateTypeLevelParams</span></a></span><span class="decl_args">
<span class="fn">(c : <a href=".././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a>)</span></span>
<span class="decl_args">
<span class="fn">(ls : <span class="fn"><a href=".././Init/Prelude.html#List">List</a> <a href=".././Lean/Level.html#Lean.Level">Lean.Level</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ConstantInfo.instantiateTypeLevelParams" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.ConstantInfo.instantiateValueLevelParams!"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L244-L245">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ConstantInfo.instantiateValueLevelParams!"><span class="name">Lean</span>.<span class="name">ConstantInfo</span>.<span class="name">instantiateValueLevelParams!</span></a></span><span class="decl_args">
<span class="fn">(c : <a href=".././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a>)</span></span>
<span class="decl_args">
<span class="fn">(ls : <span class="fn"><a href=".././Init/Prelude.html#List">List</a> <a href=".././Lean/Level.html#Lean.Level">Lean.Level</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ConstantInfo.instantiateValueLevelParams!" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterface"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L250-L258">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterface"><span class="name">Lean</span>.<span class="name">EnvExtensionInterface</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a> 1</div></div><ul class="structure_fields" id="Lean.EnvExtensionInterface.mk"><li id="Lean.EnvExtensionInterface.ext" class="structure_field"><div class="structure_field_info">ext : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span></div></li><li id="Lean.EnvExtensionInterface.inhabitedExt" class="structure_field"><div class="structure_field_info">inhabitedExt : <span class="fn">{<span class="fn">σ</span> : <a href=".././foundational_types.html">Type</a>} → <span class="fn"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span> → <span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterface.ext">Lean.EnvExtensionInterface.ext</a> <span class="fn">s</span> <span class="fn">σ</span></span>)</span></span></span></div></li><li id="Lean.EnvExtensionInterface.registerExt" class="structure_field"><div class="structure_field_info">registerExt : <span class="fn">{<span class="fn">σ</span> : <a href=".././foundational_types.html">Type</a>} → <span class="fn"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <span class="fn">σ</span></span> → <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterface.ext">Lean.EnvExtensionInterface.ext</a> <span class="fn">s</span> <span class="fn">σ</span></span>)</span></span></span></div></li><li id="Lean.EnvExtensionInterface.setState" class="structure_field"><div class="structure_field_info">setState : <span class="fn">{<span class="fn">σ</span> : <a href=".././foundational_types.html">Type</a>} → <span class="fn"><span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterface.ext">Lean.EnvExtensionInterface.ext</a> <span class="fn">s</span> <span class="fn">σ</span></span> → <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><span class="fn">σ</span> → <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></span></span></span></div></li><li id="Lean.EnvExtensionInterface.modifyState" class="structure_field"><div class="structure_field_info">modifyState : <span class="fn">{<span class="fn">σ</span> : <a href=".././foundational_types.html">Type</a>} → <span class="fn"><span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterface.ext">Lean.EnvExtensionInterface.ext</a> <span class="fn">s</span> <span class="fn">σ</span></span> → <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn">(<span class="fn"><span class="fn">σ</span> → <span class="fn">σ</span></span>) → <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></span></span></span></div></li><li id="Lean.EnvExtensionInterface.getState" class="structure_field"><div class="structure_field_info">getState : <span class="fn">{<span class="fn">σ</span> : <a href=".././foundational_types.html">Type</a>} → <span class="fn">[<span class="fn">inst</span> : <span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>] → <span class="fn"><span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterface.ext">Lean.EnvExtensionInterface.ext</a> <span class="fn">s</span> <span class="fn">σ</span></span> → <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn">σ</span></span></span></span></span></div></li><li id="Lean.EnvExtensionInterface.mkInitialExtStates" class="structure_field"><div class="structure_field_info">mkInitialExtStates : <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionState">Lean.EnvExtensionState</a></span>)</span></div></li><li id="Lean.EnvExtensionInterface.ensureExtensionsSize" class="structure_field"><div class="structure_field_info">ensureExtensionsSize : <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></span></div></li></ul><p>Interface for managing environment extensions.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterface" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instInhabitedEnvExtensionInterface"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L260-L270">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instInhabitedEnvExtensionInterface"><span class="name">Lean</span>.<span class="name">instInhabitedEnvExtensionInterface</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionInterface">Lean.EnvExtensionInterface</a></span></div></div></div></div><div class="mod_doc"><h1 class="markdown-heading" id="Unsafe-implementation-of-EnvExtensionInterface">Unsafe implementation of <code><a href=".././Lean/Environment.html#Lean.EnvExtensionInterface">EnvExtensionInterface</a></code> <a class="hover-link" href="#Unsafe-implementation-of-EnvExtensionInterface">#</a></h1></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.Ext"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L275-L278">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.Ext"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">Ext</span></a></span><span class="decl_args">
<span class="fn">(σ : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.EnvExtensionInterfaceUnsafe.Ext.mk"><li id="Lean.EnvExtensionInterfaceUnsafe.Ext.idx" class="structure_field"><div class="structure_field_info">idx : <a href=".././Init/Prelude.html#Nat">Nat</a></div></li><li id="Lean.EnvExtensionInterfaceUnsafe.Ext.mkInitial" class="structure_field"><div class="structure_field_info">mkInitial : <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <span class="fn">σ</span></span></div></li></ul><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterfaceUnsafe.Ext" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.instInhabitedExt"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L278-L278">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.instInhabitedExt"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">instInhabitedExt</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">{<span class="fn">a</span> : <a href=".././foundational_types.html">Type</a>} → <span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.Ext">Lean.EnvExtensionInterfaceUnsafe.Ext</a> <span class="fn">a</span></span>)</span></span></div></div></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.ensureExtensionsArraySize"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L289-L299">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.ensureExtensionsArraySize"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">ensureExtensionsArraySize</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></div></div><p>User-defined environment extensions are declared using the <code>initialize</code> command.
This command is just syntax sugar for the <code>init</code> attribute.
When we <code>import</code> lean modules, the vector stored at <code>envExtensionsRef</code> may increase in size because of
user-defined environment extensions. When this happens, we must adjust the size of the <code>env.<a href=".././Lean/Environment.html#Lean.Environment.extensions">extensions</a></code>.
This method is invoked when processing <code>import</code>s.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterfaceUnsafe.ensureExtensionsArraySize" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.ensureExtensionsArraySize.loop"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L292-L299">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.ensureExtensionsArraySize.loop"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">ensureExtensionsArraySize</span>.<span class="name">loop</span></a></span><span class="decl_args">
<span class="fn">(i : <a href=".././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></div></div></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.setState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L303-L308">source</a></div><div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.setState"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">setState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.Ext">Lean.EnvExtensionInterfaceUnsafe.Ext</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(s : <span class="fn">σ</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterfaceUnsafe.setState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.modifyState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L310-L319">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.modifyState"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">modifyState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.Ext">Lean.EnvExtensionInterfaceUnsafe.Ext</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(f : <span class="fn"><span class="fn">σ</span> → <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterfaceUnsafe.modifyState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.getState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L321-L326">source</a></div><div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.getState"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">getState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.Ext">Lean.EnvExtensionInterfaceUnsafe.Ext</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">σ</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterfaceUnsafe.getState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.registerExt"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L328-L338">source</a></div><div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.registerExt"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">registerExt</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(mkInitial : <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.Ext">Lean.EnvExtensionInterfaceUnsafe.Ext</a> <span class="fn">σ</span></span>)</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterfaceUnsafe.registerExt" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.mkInitialExtStates"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L340-L342">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.mkInitialExtStates"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">mkInitialExtStates</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionState">Lean.EnvExtensionState</a></span>)</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterfaceUnsafe.mkInitialExtStates" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterfaceUnsafe.imp"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L344-L353">source</a></div><div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceUnsafe.imp"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceUnsafe</span>.<span class="name">imp</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterface">Lean.EnvExtensionInterface</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtensionInterfaceUnsafe.imp" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtensionInterfaceImp"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L358-L358">source</a></div><div class="attributes">@[implemented_by Lean.EnvExtensionInterfaceUnsafe.imp]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtensionInterfaceImp"><span class="name">Lean</span>.<span class="name">EnvExtensionInterfaceImp</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.EnvExtensionInterface">Lean.EnvExtensionInterface</a></div></div></div></div><div class="decl" id="Lean.EnvExtension"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L360-L360">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtension"><span class="name">Lean</span>.<span class="name">EnvExtension</span></a></span><span class="decl_args">
<span class="fn">(σ : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtension.instInhabitedEnvExtension"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L366-L366">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtension.instInhabitedEnvExtension"><span class="name">Lean</span>.<span class="name">EnvExtension</span>.<span class="name">instInhabitedEnvExtension</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[s : <span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtension">Lean.EnvExtension</a> <span class="fn">σ</span></span>)</span></div></div></div></div><div class="decl" id="Lean.EnvExtension.setState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L367-L367">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtension.setState"><span class="name">Lean</span>.<span class="name">EnvExtension</span>.<span class="name">setState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtension">Lean.EnvExtension</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(s : <span class="fn">σ</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtension.setState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtension.modifyState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L368-L368">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtension.modifyState"><span class="name">Lean</span>.<span class="name">EnvExtension</span>.<span class="name">modifyState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtension">Lean.EnvExtension</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(f : <span class="fn"><span class="fn">σ</span> → <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtension.modifyState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.EnvExtension.getState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L369-L369">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.EnvExtension.getState"><span class="name">Lean</span>.<span class="name">EnvExtension</span>.<span class="name">getState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtension">Lean.EnvExtension</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">σ</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.EnvExtension.getState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.registerEnvExtension"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L379-L379">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.registerEnvExtension"><span class="name">Lean</span>.<span class="name">registerEnvExtension</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(mkInitial : <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtension">Lean.EnvExtension</a> <span class="fn">σ</span></span>)</span></div></div><p>Environment extensions can only be registered during initialization.
Reasons:
1- Our implementation assumes the number of extensions does not change after an environment object is created.
2- We do not use any synchronization primitive to access <code>envExtensionsRef</code>.</p><p>Note that by default, extension state is <em>not</em> stored in .olean files and will not propagate across <code>import</code>s.
For that, you need to register a persistent environment extension.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.registerEnvExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.mkEmptyEnvironment"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L383-L393">source</a></div><div class="attributes">@[export lean_mk_empty_environment]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.mkEmptyEnvironment"><span class="name">Lean</span>.<span class="name">mkEmptyEnvironment</span></a></span><span class="decl_args">
<span class="fn">(trustLevel : <span class="fn"><a href=".././Init/Prelude.html#optParam">optParam</a> <a href=".././Init/Prelude.html#UInt32">UInt32</a> <span class="fn">0</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.mkEmptyEnvironment" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.PersistentEnvExtensionState"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L395-L397">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.PersistentEnvExtensionState"><span class="name">Lean</span>.<span class="name">PersistentEnvExtensionState</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(σ : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.PersistentEnvExtensionState.mk"><li id="Lean.PersistentEnvExtensionState.importedEntries" class="structure_field"><div class="structure_field_info">importedEntries : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> (<span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span>)</span></div></li><li id="Lean.PersistentEnvExtensionState.state" class="structure_field"><div class="structure_field_info">state : <span class="fn">σ</span></div></li></ul><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.PersistentEnvExtensionState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.ImportM.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L399-L401">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ImportM.Context"><span class="name">Lean</span>.<span class="name">ImportM</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.ImportM.Context.mk"><li id="Lean.ImportM.Context.env" class="structure_field"><div class="structure_field_info">env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></li><li id="Lean.ImportM.Context.opts" class="structure_field"><div class="structure_field_info">opts : <a href=".././Lean/Data/Options.html#Lean.Options">Lean.Options</a></div></li></ul><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ImportM.Context" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.ImportM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L403-L403">source</a></div><div class="attributes">@[inline, reducible]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ImportM"><span class="name">Lean</span>.<span class="name">ImportM</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ImportM" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.PersistentEnvExtension"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L421-L427">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.PersistentEnvExtension"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(β : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(σ : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.PersistentEnvExtension.mk"><li id="Lean.PersistentEnvExtension.toEnvExtension" class="structure_field"><div class="structure_field_info">toEnvExtension : <span class="fn"><a href=".././Lean/Environment.html#Lean.EnvExtension">Lean.EnvExtension</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtensionState">Lean.PersistentEnvExtensionState</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></div></li><li id="Lean.PersistentEnvExtension.name" class="structure_field"><div class="structure_field_info">name : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></div></li><li id="Lean.PersistentEnvExtension.addImportedFn" class="structure_field"><div class="structure_field_info">addImportedFn : <span class="fn"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> (<span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span>)</span> → <span class="fn"><a href=".././Lean/Environment.html#Lean.ImportM">Lean.ImportM</a> <span class="fn">σ</span></span></span></div></li><li id="Lean.PersistentEnvExtension.addEntryFn" class="structure_field"><div class="structure_field_info">addEntryFn : <span class="fn"><span class="fn">σ</span> → <span class="fn"><span class="fn">β</span> → <span class="fn">σ</span></span></span></div></li><li id="Lean.PersistentEnvExtension.exportEntriesFn" class="structure_field"><div class="structure_field_info">exportEntriesFn : <span class="fn"><span class="fn">σ</span> → <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span></span></div></li><li id="Lean.PersistentEnvExtension.statsFn" class="structure_field"><div class="structure_field_info">statsFn : <span class="fn"><span class="fn">σ</span> → <a href=".././Init/Data/Format/Basic.html#Std.Format">Lean.Format</a></span></div></li></ul><p>An environment extension with support for storing/retrieving entries from a .olean file.</p><ul>
<li>α is the type of the entries that are stored in .olean files.</li>
<li>β is the type of values used to update the state.</li>
<li>σ is the actual state.</li>
</ul><p>Remark: for most extensions α and β coincide.</p><p>Note that <code><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension.addEntryFn">addEntryFn</a></code> is not in <code><a href=".././Init/System/IO.html#IO">IO</a></code>. This is intentional, and allows us to write simple functions such as</p><pre><code>def addAlias (env : Environment) (a : Name) (e : Name) : <a href=".././Lean/Environment.html#Lean.Environment">Environment</a> :=
aliasExtension.<a href=".././Lean/Environment.html#Lean.PersistentEnvExtension.addEntry">addEntry</a> <a href=".././Lean/Environment.html#Lean.ImportM.Context.env">env</a> (a, e)
</code></pre><p>without using <code><a href=".././Init/System/IO.html#IO">IO</a></code>. We have many functions like <code>addAlias</code>.</p><p><code>α</code> and ‵β` do not coincide for extensions where the data used to update the state contains, for example,
closures which we currently cannot store in files.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.PersistentEnvExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.instInhabitedPersistentEnvExtensionState"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L429-L430">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instInhabitedPersistentEnvExtensionState"><span class="name">Lean</span>.<span class="name">instInhabitedPersistentEnvExtensionState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtensionState">Lean.PersistentEnvExtensionState</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></div></div></div></div><div class="decl" id="Lean.instInhabitedPersistentEnvExtension"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L432-L440">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instInhabitedPersistentEnvExtension"><span class="name">Lean</span>.<span class="name">instInhabitedPersistentEnvExtension</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{β : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></div></div></div></div><div class="decl" id="Lean.PersistentEnvExtension.getModuleEntries"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L444-L445">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.PersistentEnvExtension.getModuleEntries"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">getModuleEntries</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{β : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(m : <a href=".././Lean/Environment.html#Lean.ModuleIdx">Lean.ModuleIdx</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.PersistentEnvExtension.getModuleEntries" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.PersistentEnvExtension.addEntry"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L447-L450">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.PersistentEnvExtension.addEntry"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">addEntry</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{β : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(b : <span class="fn">β</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.PersistentEnvExtension.addEntry" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.PersistentEnvExtension.getState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L453-L454">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.PersistentEnvExtension.getState"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">getState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{β : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">σ</span></div></div><p>Get the current state of the given extension in the given environment.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.PersistentEnvExtension.getState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.PersistentEnvExtension.setState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L457-L458">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.PersistentEnvExtension.setState"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">setState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{β : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(s : <span class="fn">σ</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><p>Set the current state of the given extension in the given environment. This change is <em>not</em> persisted across files.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.PersistentEnvExtension.setState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.PersistentEnvExtension.modifyState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L461-L462">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.PersistentEnvExtension.modifyState"><span class="name">Lean</span>.<span class="name">PersistentEnvExtension</span>.<span class="name">modifyState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{β : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(f : <span class="fn"><span class="fn">σ</span> → <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><p>Modify the state of the given extension in the given environment by applying the given function. This change is <em>not</em> persisted across files.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.PersistentEnvExtension.modifyState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.persistentEnvExtensionsRef"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L466-L466">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.persistentEnvExtensionsRef"><span class="name">Lean</span>.<span class="name">persistentEnvExtensionsRef</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO.Ref">IO.Ref</a> (<span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionEntry">Lean.EnvExtensionEntry</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionEntry">Lean.EnvExtensionEntry</a> <a href=".././Lean/Environment.html#Lean.EnvExtensionState">Lean.EnvExtensionState</a></span>)</span>)</span></div></div></div></div><div class="decl" id="Lean.PersistentEnvExtensionDescr"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L468-L474">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.PersistentEnvExtensionDescr"><span class="name">Lean</span>.<span class="name">PersistentEnvExtensionDescr</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(β : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(σ : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.PersistentEnvExtensionDescr.mk"><li id="Lean.PersistentEnvExtensionDescr.name" class="structure_field"><div class="structure_field_info">name : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></div></li><li id="Lean.PersistentEnvExtensionDescr.mkInitial" class="structure_field"><div class="structure_field_info">mkInitial : <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <span class="fn">σ</span></span></div></li><li id="Lean.PersistentEnvExtensionDescr.addImportedFn" class="structure_field"><div class="structure_field_info">addImportedFn : <span class="fn"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> (<span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span>)</span> → <span class="fn"><a href=".././Lean/Environment.html#Lean.ImportM">Lean.ImportM</a> <span class="fn">σ</span></span></span></div></li><li id="Lean.PersistentEnvExtensionDescr.addEntryFn" class="structure_field"><div class="structure_field_info">addEntryFn : <span class="fn"><span class="fn">σ</span> → <span class="fn"><span class="fn">β</span> → <span class="fn">σ</span></span></span></div></li><li id="Lean.PersistentEnvExtensionDescr.exportEntriesFn" class="structure_field"><div class="structure_field_info">exportEntriesFn : <span class="fn"><span class="fn">σ</span> → <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span></span></div></li><li id="Lean.PersistentEnvExtensionDescr.statsFn" class="structure_field"><div class="structure_field_info">statsFn : <span class="fn"><span class="fn">σ</span> → <a href=".././Init/Data/Format/Basic.html#Std.Format">Lean.Format</a></span></div></li></ul><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.PersistentEnvExtensionDescr" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.registerPersistentEnvExtensionUnsafe"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L476-L495">source</a></div><div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.registerPersistentEnvExtensionUnsafe"><span class="name">Lean</span>.<span class="name">registerPersistentEnvExtensionUnsafe</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{β : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(descr : <span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtensionDescr">Lean.PersistentEnvExtensionDescr</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.registerPersistentEnvExtensionUnsafe" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.registerPersistentEnvExtension"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L498-L498">source</a></div><div class="attributes">@[implemented_by Lean.registerPersistentEnvExtensionUnsafe]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.registerPersistentEnvExtension"><span class="name">Lean</span>.<span class="name">registerPersistentEnvExtension</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{β : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(descr : <span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtensionDescr">Lean.PersistentEnvExtensionDescr</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">Lean.PersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">β</span> <span class="fn">σ</span></span>)</span></div></div></div></div><div class="decl" id="Lean.SimplePersistentEnvExtension"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L501-L501">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(σ : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>Simple <code><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension">PersistentEnvExtension</a></code> that implements <code><a href=".././Lean/Environment.html#Lean.PersistentEnvExtension.exportEntriesFn">exportEntriesFn</a></code> using a list of entries.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.SimplePersistentEnvExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.mkStateFromImportedEntries"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L503-L504">source</a></div><div class="attributes">@[specialize #[]]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.mkStateFromImportedEntries"><span class="name">Lean</span>.<span class="name">mkStateFromImportedEntries</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(addEntryFn : <span class="fn"><span class="fn">σ</span> → <span class="fn"><span class="fn">α</span> → <span class="fn">σ</span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(initState : <span class="fn">σ</span>)</span></span>
<span class="decl_args">
<span class="fn">(as : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> (<span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span>)</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">σ</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.mkStateFromImportedEntries" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.SimplePersistentEnvExtensionDescr"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L506-L510">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtensionDescr"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtensionDescr</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(σ : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.SimplePersistentEnvExtensionDescr.mk"><li id="Lean.SimplePersistentEnvExtensionDescr.name" class="structure_field"><div class="structure_field_info">name : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></div></li><li id="Lean.SimplePersistentEnvExtensionDescr.addEntryFn" class="structure_field"><div class="structure_field_info">addEntryFn : <span class="fn"><span class="fn">σ</span> → <span class="fn"><span class="fn">α</span> → <span class="fn">σ</span></span></span></div></li><li id="Lean.SimplePersistentEnvExtensionDescr.addImportedFn" class="structure_field"><div class="structure_field_info">addImportedFn : <span class="fn"><span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> (<span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span>)</span> → <span class="fn">σ</span></span></div></li><li id="Lean.SimplePersistentEnvExtensionDescr.toArrayFn" class="structure_field"><div class="structure_field_info">toArrayFn : <span class="fn"><span class="fn"><a href=".././Init/Prelude.html#List">List</a> <span class="fn">α</span></span> → <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span></span></div></li></ul><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.SimplePersistentEnvExtensionDescr" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.registerSimplePersistentEnvExtension"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L512-L521">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.registerSimplePersistentEnvExtension"><span class="name">Lean</span>.<span class="name">registerSimplePersistentEnvExtension</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(descr : <span class="fn"><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtensionDescr">Lean.SimplePersistentEnvExtensionDescr</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">Lean.SimplePersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.registerSimplePersistentEnvExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.SimplePersistentEnvExtension.instInhabitedSimplePersistentEnvExtension"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L525-L526">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension.instInhabitedSimplePersistentEnvExtension"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">instInhabitedSimplePersistentEnvExtension</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">Lean.SimplePersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></div></div></div></div><div class="decl" id="Lean.SimplePersistentEnvExtension.getEntries"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L530-L531">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension.getEntries"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">getEntries</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">Lean.SimplePersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#List">List</a> <span class="fn">α</span></span></div></div><p>Get the list of values used to update the state of the given
<code><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">SimplePersistentEnvExtension</a></code> in the current file.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.SimplePersistentEnvExtension.getEntries" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.SimplePersistentEnvExtension.getState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L534-L535">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension.getState"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">getState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">σ</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">Lean.SimplePersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">σ</span></div></div><p>Get the current state of the given <code><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">SimplePersistentEnvExtension</a></code>.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.SimplePersistentEnvExtension.getState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.SimplePersistentEnvExtension.setState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L538-L539">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension.setState"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">setState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">Lean.SimplePersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(s : <span class="fn">σ</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><p>Set the current state of the given <code><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">SimplePersistentEnvExtension</a></code>. This change is <em>not</em> persisted across files.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.SimplePersistentEnvExtension.setState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.SimplePersistentEnvExtension.modifyState"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L542-L543">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension.modifyState"><span class="name">Lean</span>.<span class="name">SimplePersistentEnvExtension</span>.<span class="name">modifyState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{σ : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">Lean.SimplePersistentEnvExtension</a> <span class="fn">α</span> <span class="fn">σ</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(f : <span class="fn"><span class="fn">σ</span> → <span class="fn">σ</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><p>Modify the state of the given extension in the given environment by applying the given function. This change is <em>not</em> persisted across files.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.SimplePersistentEnvExtension.modifyState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.TagDeclarationExtension"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L549-L549">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.TagDeclarationExtension"><span class="name">Lean</span>.<span class="name">TagDeclarationExtension</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>Environment extension for tagging declarations.
Declarations must only be tagged in the module where they were declared.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.TagDeclarationExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.mkTagDeclarationExtension"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L551-L557">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.mkTagDeclarationExtension"><span class="name">Lean</span>.<span class="name">mkTagDeclarationExtension</span></a></span><span class="decl_args">
<span class="fn">(name : <span class="fn"><a href=".././Init/Meta.html#autoParam">autoParam</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> <a href=".././Lean/Environment.html#_auto._@.Lean.Environment._hyg.3748">_auto✝</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.TagDeclarationExtension">Lean.TagDeclarationExtension</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.mkTagDeclarationExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.TagDeclarationExtension.instInhabitedTagDeclarationExtension"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L561-L562">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.TagDeclarationExtension.instInhabitedTagDeclarationExtension"><span class="name">Lean</span>.<span class="name">TagDeclarationExtension</span>.<span class="name">instInhabitedTagDeclarationExtension</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <a href=".././Lean/Environment.html#Lean.TagDeclarationExtension">Lean.TagDeclarationExtension</a></span></div></div></div></div><div class="decl" id="Lean.TagDeclarationExtension.tag"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L564-L567">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.TagDeclarationExtension.tag"><span class="name">Lean</span>.<span class="name">TagDeclarationExtension</span>.<span class="name">tag</span></a></span><span class="decl_args">
<span class="fn">(ext : <a href=".././Lean/Environment.html#Lean.TagDeclarationExtension">Lean.TagDeclarationExtension</a>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(declName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.TagDeclarationExtension.tag" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.TagDeclarationExtension.isTagged"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L569-L572">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.TagDeclarationExtension.isTagged"><span class="name">Lean</span>.<span class="name">TagDeclarationExtension</span>.<span class="name">isTagged</span></a></span><span class="decl_args">
<span class="fn">(ext : <a href=".././Lean/Environment.html#Lean.TagDeclarationExtension">Lean.TagDeclarationExtension</a>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(declName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.TagDeclarationExtension.isTagged" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.MapDeclarationExtension"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L579-L579">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.MapDeclarationExtension"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>Environment extension for mapping declarations to values.
Declarations must only be inserted into the mapping in the module where they were declared.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.MapDeclarationExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.mkMapDeclarationExtension"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L581-L587">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.mkMapDeclarationExtension"><span class="name">Lean</span>.<span class="name">mkMapDeclarationExtension</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(name : <span class="fn"><a href=".././Init/Meta.html#autoParam">autoParam</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> <a href=".././Lean/Environment.html#_auto._@.Lean.Environment._hyg.3988">_auto✝</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.MapDeclarationExtension">Lean.MapDeclarationExtension</a> <span class="fn">α</span></span>)</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.mkMapDeclarationExtension" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.MapDeclarationExtension.instInhabitedMapDeclarationExtension"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L591-L592">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.MapDeclarationExtension.instInhabitedMapDeclarationExtension"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span>.<span class="name">instInhabitedMapDeclarationExtension</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.MapDeclarationExtension">Lean.MapDeclarationExtension</a> <span class="fn">α</span></span>)</span></div></div></div></div><div class="decl" id="Lean.MapDeclarationExtension.insert"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L594-L597">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.MapDeclarationExtension.insert"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span>.<span class="name">insert</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.MapDeclarationExtension">Lean.MapDeclarationExtension</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(declName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(val : <span class="fn">α</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.MapDeclarationExtension.insert" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.MapDeclarationExtension.find?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L599-L605">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.MapDeclarationExtension.find?"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span>.<span class="name">find?</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.MapDeclarationExtension">Lean.MapDeclarationExtension</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(declName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Option">Option</a> <span class="fn">α</span></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.MapDeclarationExtension.find?" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.MapDeclarationExtension.contains"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L607-L610">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.MapDeclarationExtension.contains"><span class="name">Lean</span>.<span class="name">MapDeclarationExtension</span>.<span class="name">contains</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Inhabited">Inhabited</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(ext : <span class="fn"><a href=".././Lean/Environment.html#Lean.MapDeclarationExtension">Lean.MapDeclarationExtension</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(declName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.MapDeclarationExtension.contains" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.saveModuleData"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L615-L615">source</a></div><div class="attributes">@[extern  lean_save_module_data]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.saveModuleData"><span class="name">Lean</span>.<span class="name">saveModuleData</span></a></span><span class="decl_args">
<span class="fn">(fname : <a href=".././Init/System/FilePath.html#System.FilePath">Lake.FilePath</a>)</span></span>
<span class="decl_args">
<span class="fn">(mod : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(data : <a href=".././Lean/Environment.html#Lean.ModuleData">Lean.ModuleData</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Init/Prelude.html#Unit">Unit</a></span></div></div></div></div><div class="decl" id="Lean.readModuleData"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L617-L617">source</a></div><div class="attributes">@[extern  lean_read_module_data]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.readModuleData"><span class="name">Lean</span>.<span class="name">readModuleData</span></a></span><span class="decl_args">
<span class="fn">(fname : <a href=".././Init/System/FilePath.html#System.FilePath">Lake.FilePath</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Environment.html#Lean.ModuleData">Lean.ModuleData</a> <a href=".././Init/Prelude.html#Prod">×</a> <a href=".././Lean/Environment.html#Lean.CompactedRegion">Lean.CompactedRegion</a></span>)</span></div></div></div></div><div class="decl" id="Lean.Environment.freeRegions"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L623-L639">source</a></div><div class="attributes">@[noinline, export lean_environment_free_regions]</div>
<div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.freeRegions"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">freeRegions</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Free compacted regions of imports. No live references to imported objects may exist at the time of invocation; in
particular, <code><a href=".././Lean/Environment.html#Lean.ImportM.Context.env">env</a></code> should be the last reference to any <code><a href=".././Lean/Environment.html#Lean.Environment">Environment</a></code> derived from these imports.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.freeRegions" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.mkModuleData"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L641-L652">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.mkModuleData"><span class="name">Lean</span>.<span class="name">mkModuleData</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.ModuleData">Lean.ModuleData</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.mkModuleData" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.writeModule"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L655-L656">source</a></div><div class="attributes">@[export lean_write_module]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.writeModule"><span class="name">Lean</span>.<span class="name">writeModule</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(fname : <a href=".././Init/System/FilePath.html#System.FilePath">Lake.FilePath</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Init/Prelude.html#Unit">Unit</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.writeModule" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.mkExtNameMap"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L662-L669">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.mkExtNameMap"><span class="name">Lean</span>.<span class="name">mkExtNameMap</span></a></span><span class="decl_args">
<span class="fn">(startingAt : <a href=".././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href=".././Lean/Data/HashMap.html#Lean.HashMap">Lean.HashMap</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> <a href=".././Init/Prelude.html#Nat">Nat</a></span>)</span></div></div><p>Construct a mapping from persistent extension name to entension index at the array of persistent extensions.
We only consider extensions starting with index <code>>= startingAt</code>.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.mkExtNameMap" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.updateEnvAttributes"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L696-L696">source</a></div><div class="attributes">@[extern 2 lean_update_env_attributes]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.updateEnvAttributes"><span class="name">Lean</span>.<span class="name">updateEnvAttributes</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></span></div></div><p>"Forward declaration" needed for updating the attribute table with user-defined attributes.
User-defined attributes are declared using the <code>initialize</code> command. The <code>initialize</code> command is just syntax sugar for the <code>init</code> attribute.
The <code>init</code> attribute is initialized after the <code>attributeExtension</code> is initialized. We cannot change the order since the <code>init</code> attribute is an attribute,
and requires this extension.
The <code>attributeExtension</code> initializer uses <code>attributeMapRef</code> to initialize the attribute mapping.
When we a new user-defined attribute declaration is imported, <code>attributeMapRef</code> is updated.
Later, we set this method with code that adds the user-defined attributes that were imported after we initialized <code>attributeExtension</code>.</p></div></div><div class="decl" id="Lean.getNumBuiltinAttributes"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L698-L698">source</a></div><div class="attributes">@[extern 1 lean_get_num_attributes]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.getNumBuiltinAttributes"><span class="name">Lean</span>.<span class="name">getNumBuiltinAttributes</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Init/Prelude.html#Nat">Nat</a></span></div></div><p>"Forward declaration" for retrieving the number of builtin attributes.</p></div></div><div class="decl" id="Lean.ImportState"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L725-L729">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ImportState"><span class="name">Lean</span>.<span class="name">ImportState</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.ImportState.mk"><li id="Lean.ImportState.moduleNameSet" class="structure_field"><div class="structure_field_info">moduleNameSet : <a href=".././Lean/Data/NameMap.html#Lean.NameHashSet">Lean.NameHashSet</a></div></li><li id="Lean.ImportState.moduleNames" class="structure_field"><div class="structure_field_info">moduleNames : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a></span></div></li><li id="Lean.ImportState.moduleData" class="structure_field"><div class="structure_field_info">moduleData : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.ModuleData">Lean.ModuleData</a></span></div></li><li id="Lean.ImportState.regions" class="structure_field"><div class="structure_field_info">regions : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.CompactedRegion">Lean.CompactedRegion</a></span></div></li></ul><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ImportState" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.throwAlreadyImported"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L731-L734">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.throwAlreadyImported"><span class="name">Lean</span>.<span class="name">throwAlreadyImported</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(s : <a href=".././Lean/Environment.html#Lean.ImportState">Lean.ImportState</a>)</span></span>
<span class="decl_args">
<span class="fn">(const2ModIdx : <span class="fn"><a href=".././Lean/Data/HashMap.html#Lean.HashMap">Lean.HashMap</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> <a href=".././Lean/Environment.html#Lean.ModuleIdx">Lean.ModuleIdx</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(modIdx : <a href=".././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(cname : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <span class="fn">α</span></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.throwAlreadyImported" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.ImportStateM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L736-L736">source</a></div><div class="attributes">@[inline, reducible]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ImportStateM"><span class="name">Lean</span>.<span class="name">ImportStateM</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ImportStateM" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.ImportStateM.run"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L738-L739">source</a></div><div class="attributes">@[inline]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.ImportStateM.run"><span class="name">Lean</span>.<span class="name">ImportStateM</span>.<span class="name">run</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(x : <span class="fn"><a href=".././Lean/Environment.html#Lean.ImportStateM">Lean.ImportStateM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(s : <span class="fn"><a href=".././Init/Prelude.html#optParam">optParam</a> <a href=".././Lean/Environment.html#Lean.ImportState">Lean.ImportState</a> <span class="fn">{ <span class="fn">moduleNameSet</span> := <a href=".././Init/Core.html#EmptyCollection.emptyCollection">∅</a>, <span class="fn">moduleNames</span> := <span class="fn">#[]</span>, <span class="fn">moduleData</span> := <span class="fn">#[]</span>, <span class="fn">regions</span> := <span class="fn">#[]</span> }</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> (<span class="fn"><span class="fn">α</span> <a href=".././Init/Prelude.html#Prod">×</a> <a href=".././Lean/Environment.html#Lean.ImportState">Lean.ImportState</a></span>)</span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.ImportStateM.run" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.importModulesCore"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L741-L755">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.importModulesCore"><span class="name">Lean</span>.<span class="name">importModulesCore</span></a></span><span class="decl_args">
<span class="fn">(imports : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Lean/Environment.html#Lean.ImportStateM">Lean.ImportStateM</a> <a href=".././Init/Prelude.html#Unit">Unit</a></span></div></div></div></div><div class="decl" id="Lean.finalizeImport"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L757-L791">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.finalizeImport"><span class="name">Lean</span>.<span class="name">finalizeImport</span></a></span><span class="decl_args">
<span class="fn">(s : <a href=".././Lean/Environment.html#Lean.ImportState">Lean.ImportState</a>)</span></span>
<span class="decl_args">
<span class="fn">(imports : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(opts : <a href=".././Lean/Data/Options.html#Lean.Options">Lean.Options</a>)</span></span>
<span class="decl_args">
<span class="fn">(trustLevel : <span class="fn"><a href=".././Init/Prelude.html#optParam">optParam</a> <a href=".././Init/Prelude.html#UInt32">UInt32</a> <span class="fn">0</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.finalizeImport" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.importModules"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L794-L801">source</a></div><div class="attributes">@[export lean_import_modules]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.importModules"><span class="name">Lean</span>.<span class="name">importModules</span></a></span><span class="decl_args">
<span class="fn">(imports : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(opts : <a href=".././Lean/Data/Options.html#Lean.Options">Lean.Options</a>)</span></span>
<span class="decl_args">
<span class="fn">(trustLevel : <span class="fn"><a href=".././Init/Prelude.html#optParam">optParam</a> <a href=".././Init/Prelude.html#UInt32">UInt32</a> <span class="fn">0</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.importModules" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.withImportModules"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L806-L808">source</a></div><div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.withImportModules"><span class="name">Lean</span>.<span class="name">withImportModules</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(imports : <span class="fn"><a href=".././Init/Prelude.html#Array">Array</a> <a href=".././Lean/Environment.html#Lean.Import">Lean.Import</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(opts : <a href=".././Lean/Data/Options.html#Lean.Options">Lean.Options</a>)</span></span>
<span class="decl_args">
<span class="fn">(trustLevel : <span class="fn"><a href=".././Init/Prelude.html#optParam">optParam</a> <a href=".././Init/Prelude.html#UInt32">UInt32</a> <span class="fn">0</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(act : <span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <span class="fn">α</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <span class="fn">α</span></span></div></div><p>Create environment object from imports and free compacted regions after calling <code>act</code>. No live references to the
environment object or imported objects may exist after <code>act</code> finishes.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.withImportModules" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.namespacesExt"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L810-L826">source</a></div><div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.namespacesExt"><span class="name">Lean</span>.<span class="name">namespacesExt</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Lean/Environment.html#Lean.SimplePersistentEnvExtension">Lean.SimplePersistentEnvExtension</a> <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a> <a href=".././Lean/Data/NameMap.html#Lean.NameSSet">Lean.NameSSet</a></span></div></div><p>Environment extension for tracking all <code>namespace</code> declared by users.</p></div></div><div class="decl" id="Lean.Environment.registerNamespace"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L831-L832">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.registerNamespace"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">registerNamespace</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(n : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><p>Register a new namespace in the environment.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.registerNamespace" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.isNamespace"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L835-L836">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.isNamespace"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">isNamespace</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(n : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><p>Return <code>true</code> if <code>n</code> is the name of a namespace in <code><a href=".././Lean/Environment.html#Lean.ImportM.Context.env">env</a></code>.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.isNamespace" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.getNamespaceSet"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L839-L840">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.getNamespaceSet"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">getNamespaceSet</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Data/NameMap.html#Lean.NameSSet">Lean.NameSSet</a></div></div><p>Return a set containing all namespaces in <code><a href=".././Lean/Environment.html#Lean.ImportM.Context.env">env</a></code>.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.getNamespaceSet" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.add"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L852-L854">source</a></div><div class="attributes">@[export lean_environment_add]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.add"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">add</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(cinfo : <a href=".././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.add" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.displayStats"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L857-L873">source</a></div><div class="attributes">@[export lean_display_stats]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.displayStats"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">displayStats</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/System/IO.html#IO">IO</a> <a href=".././Init/Prelude.html#Unit">Unit</a></span></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.displayStats" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.evalConst"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L880-L880">source</a></div><div class="attributes">@[extern  lean_eval_const]</div>
<div class="decl_header"><span class="decl_kind">unsafe opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.evalConst"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">evalConst</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a> u_1)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(opts : <a href=".././Lean/Data/Options.html#Lean.Options">Lean.Options</a>)</span></span>
<span class="decl_args">
<span class="fn">(constName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Except">Except</a> <a href=".././Init/Prelude.html#String">String</a> <span class="fn">α</span></span></div></div><p>Evaluate the given declaration under the given environment to a value of the given type.
This function is only safe to use if the type matches the declaration's type in the environment
and if <code>enableInitializersExecution</code> has been used before importing any modules.</p></div></div><div class="decl" id="Lean.Environment.evalConstCheck"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L887-L895">source</a></div><div class="decl_header"><span class="decl_kind">unsafe def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.evalConstCheck"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">evalConstCheck</span></a></span><span class="decl_args">
<span class="fn">(α : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(opts : <a href=".././Lean/Data/Options.html#Lean.Options">Lean.Options</a>)</span></span>
<span class="decl_args">
<span class="fn">(typeName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(constName : <a href=".././Init/Prelude.html#Lean.Name">Lake.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Control/Except.html#ExceptT">ExceptT</a> <a href=".././Init/Prelude.html#String">String</a> <a href=".././Init/Control/Id.html#Id">Id</a> <span class="fn">α</span></span></div></div><p>Like <code><a href=".././Lean/Environment.html#Lean.Environment.evalConst">evalConst</a></code>, but first check that <code>constName</code> indeed is a declaration of type <code>typeName</code>.
Note that this function cannot guarantee that <code>typeName</code> is in fact the name of the type <code>α</code>.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.evalConstCheck" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Environment.hasUnsafe"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L897-L904">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Environment.hasUnsafe"><span class="name">Lean</span>.<span class="name">Environment</span>.<span class="name">hasUnsafe</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(e : <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Environment.hasUnsafe" class="instances-for-list"></ul></details></div></div><div class="mod_doc"><h1 class="markdown-heading" id="Kernel-API">Kernel API <a class="hover-link" href="#Kernel-API">#</a></h1></div><div class="decl" id="Lean.Kernel.isDefEq"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L916-L916">source</a></div><div class="attributes">@[extern  lean_kernel_is_def_eq]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Kernel.isDefEq"><span class="name">Lean</span>.<span class="name">Kernel</span>.<span class="name">isDefEq</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(lctx : <a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a>)</span></span>
<span class="decl_args">
<span class="fn">(a : <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(b : <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Except">Except</a> <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a> <a href=".././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Kernel isDefEq predicate. We use it mainly for debugging purposes.
Recall that the Kernel type checker does not support metavariables.
When implementing automation, consider using the <code>MetaM</code> methods.</p></div></div><div class="decl" id="Lean.Kernel.isDefEqGuarded"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L918-L919">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Kernel.isDefEqGuarded"><span class="name">Lean</span>.<span class="name">Kernel</span>.<span class="name">isDefEqGuarded</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(lctx : <a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a>)</span></span>
<span class="decl_args">
<span class="fn">(a : <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args">
<span class="fn">(b : <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Bool">Bool</a></div></div><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Lean.Kernel.isDefEqGuarded" class="instances-for-list"></ul></details></div></div><div class="decl" id="Lean.Kernel.whnf"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L926-L926">source</a></div><div class="attributes">@[extern  lean_kernel_whnf]</div>
<div class="decl_header"><span class="decl_kind">opaque</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.Kernel.whnf"><span class="name">Lean</span>.<span class="name">Kernel</span>.<span class="name">whnf</span></a></span><span class="decl_args">
<span class="fn">(env : <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a>)</span></span>
<span class="decl_args">
<span class="fn">(lctx : <a href=".././Lean/LocalContext.html#Lean.LocalContext">Lean.LocalContext</a>)</span></span>
<span class="decl_args">
<span class="fn">(a : <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Except">Except</a> <a href=".././Lean/Environment.html#Lean.KernelException">Lean.KernelException</a> <a href=".././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span></div></div><p>Kernel WHNF function. We use it mainly for debugging purposes.
Recall that the Kernel type checker does not support metavariables.
When implementing automation, consider using the <code>MetaM</code> methods.</p></div></div><div class="decl" id="Lean.MonadEnv"><div class="class"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L930-L932">source</a></div><div class="decl_header"><span class="decl_kind">class</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.MonadEnv"><span class="name">Lean</span>.<span class="name">MonadEnv</span></a></span><span class="decl_args">
<span class="fn">(m : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Lean.MonadEnv.mk"><li id="Lean.MonadEnv.getEnv" class="structure_field"><div class="structure_field_info">getEnv : <span class="fn"><span class="fn">m</span> <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span></div></li><li id="Lean.MonadEnv.modifyEnv" class="structure_field"><div class="structure_field_info">modifyEnv : <span class="fn">(<span class="fn"><a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a> → <a href=".././Lean/Environment.html#Lean.Environment">Lean.Environment</a></span>) → <span class="fn"><span class="fn">m</span> <a href=".././Init/Prelude.html#Unit">Unit</a></span></span></div></li></ul><details class="instances"><summary>Instances</summary><ul id="instances-list-Lean.MonadEnv" class="instances-list"></ul></details></div></div><div class="decl" id="Lean.instMonadEnv"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/a62d2fd4979671b76b8ab13ccbe4fdf410ec0d9d/src/Lean/Environment.lean#L937-L939">source</a></div><div class="attributes">@[always_inline]</div>
<div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././Lean/Environment.html#Lean.instMonadEnv"><span class="name">Lean</span>.<span class="name">instMonadEnv</span></a></span><span class="decl_args">
<span class="fn">(m : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(n : <span class="fn"><a href=".././foundational_types.html">Type</a> → <a href=".././foundational_types.html">Type</a></span>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#MonadLift">MonadLift</a> <span class="fn">m</span> <span class="fn">n</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Lean/Environment.html#Lean.MonadEnv">Lean.MonadEnv</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Lean/Environment.html#Lean.MonadEnv">Lean.MonadEnv</a> <span class="fn">n</span></span></div></div></div></div></main>
<nav class="nav"><iframe src=".././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>